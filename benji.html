<html>

<head>
  <link href="https://cdn.jsdelivr.net/npm/daisyui@latest/dist/full.css" rel="stylesheet" type="text/css" />
  <script src="https://cdn.tailwindcss.com"></script>

  <script type="module" src="/custom-dropdown.js"></script>
  <script type="module" src="/my-component.js"></script>

  <style type="text/css">
    .redFont {
      color: red;
    }

    .blueFont {
      color: blue;
    }
  </style>
</head>

<body>
  <main data-theme="coffee" class="p-10">

    <header class="flex flex-row justify-between">
      <nav>
        <h1 class="text-4xl">Preact App</h1>
        <h2 class="text-2xl">with shared State with classic javascript</h2>
      </nav>
      <div class="navbar-end">
        <label for="my-modal-4" class="btn btn-ghost btn-circle">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        </label>
      </div>
      <area>
      <input type="checkbox" id="my-modal-4" class="modal-toggle">
      <div class="modal">
        <div class="modal-box relative">
          <label for="my-modal-4" class="btn btn-sm btn-circle border-none bg-base-100 text-black font-bold absolute right-2 top-2">âœ•</label>
          <div class="form-control pr-6">
            <input type="text" placeholder="Search" class="input input-bordered bg-base-100 "/>
          </div>
        </div>
      </div>
      </area>
    </header>

    <div id="preact" class="m-10"></div>

    <hr class="m-10" />

    <section class="flex flex-col justify-between">
      <custom-dropdown class="m-16"></custom-dropdown>

      <div class="flex flex-row justify-around">
        <div class="one-half column">
          <my-component id="prvy" name="First custom lit-element:"></my-component>
        </div>
        <div class="one-half column">
          <my-component id="druhy" name="Second custom lit-element:"></my-component>
        </div>
      </div>


      <script>
        const prvy = document.querySelector('#prvy');
        this.interval = window.setInterval(() => {
          prvy.vonkajsia = new Date().toLocaleTimeString();
        }, 1000);
      </script>
    </section>

    <section>
      <ul class="menu bg-base-100 w-56 rounded-box">
        <li id="myArticle1">
          <a class="redFont">Article 1</a>
        </li>
        <li id="myArticle2">
          <a class="redFont">Article 2</a>
        </li>
        <li id="myArticle3" class="bordered">
          <a class="blueFont ">Article 3</a>
        </li>
        <li id="myArticle4">
          <a class="redFont">Article 4</a>
        </li>
      </ul>

      <button class="btn btn-primary" onclick="myOnclick()">Click to Set Date</button>
    </section>
  </main>

</body>

<script type="module">
  import { html, Component, render } from 'https://unpkg.com/htm/preact/standalone.module.js';
  import { store, getStateText, setStateText } from "/store.js";
  class MyApp extends Component {
    state = store;
    onKeyUp = e => {
      console.log(e.target.value);
      setStateText(e.target.value)
      const { mytext } = store;
      this.setState({ mytext: mytext });
    }
    clearSearch = e => {
      this.setState({ mytext: ""});
    }
    deleteAll = e => {
      const { mylist, mytext } = store;
      mylist.length = 0;
      this.setState({ mylist: mylist, mytext: mytext });
    }
    onSubmit = e => {
      alert("Submitted");
      e.preventDefault();
    }
    addTodo = e => {
      const { mylist, mytext } = store;
      mylist.push(`todo ${mylist.length} state ${mytext}.`);
      console.log(mylist);
      this.setState({ mylist: mylist, mytext: mytext });
    }
    render({ page }) {
      return html`
        <form class="grid justify-items-start" onSubmit=${this.onSubmit}>
          <${TopPart} name="ToDo's (${page})" />
          <div>
            <a class="btn btn-accent" onClick=${this.addTodo}>Add Todo</a>
            <input value=${this.state.mytext} onKeyUp=${this.onKeyUp} type="text" placeholder="Search" class="input input-bordered" />
            <a class="btn btn-secondary" onClick=${this.clearSearch}>Clear Search</a>
            <a class="btn btn-primary" onClick=${this.deleteAll}>Delete All</a>
          </div>
          <ul class="menu rounded-box">
            ${this.state.mylist.filter(i => i.includes(this.state.mytext)).map(todo => html`
              <li key=${todo}><a>${todo}</a></li>
            `)}
          </ul>
          <${Footer}><pre>footer content here</pre><//>
          <button class="btn btn-accent" type="submit">Submit</button>
        </form>
      `;
    }
  }

  const TopPart = ({ name }) => html`<h1 class="text-2xl p-5">${name} List</h1>`
  const Footer = props => html`<footer ...${props} />`
  render(html`<${MyApp} page="All" />`, document.querySelector('#preact'));
</script>

<script>
  function myOnclick() {
    // toto je moja poznamka k tomut teraz
    console.warn("event dispatched now.")

    // Get all elements that have cssClass .redFont
    const myArray = document.querySelectorAll(".redFont");


    // Create new instance of class DateManager
    const instance = new DateManager();

    // Set property dateArray on this new instance
    instance.dateArray = myArray;

    // Call method setdates
    instance.setDates(myArray);
  }


  // Define class DateManager
  class DateManager {
    dateArray;

    setDates() {
      let index = 0;

      // Iterate over all elements in dateArray 
      this.dateArray.forEach(e => {
        console.info(index)

        const datum = new Date();

        e.innerHTML = datum.toLocaleTimeString();

        index++;
      });
    }
  }


</script>

</html>